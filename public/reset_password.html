<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="javascripts/login.js"></script>
    <link rel="stylesheet" href="stylesheets/register.css">
    <script src="https://kit.fontawesome.com/f48b9c11bb.js" crossorigin="anonymous"></script>
    <title>Reset password</title>
</head>
<body>
<div class="container">
    <div class="con_forms">
        <img src="images/logo.png" title="The Best Company" alt="This our pretty logo" onclick="location.href=('main.html')">
        <div class="login_register">
            <form action="" class="sign_in">
                <h2 class="title">Reset Password</h2>

                <div class="input_box">
                    <i class="fa-solid fa-user"></i>
                    <input type="text"  placeholder="Enter You User Name" id="Name" required>
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-envelope"></i>
                    <input class="ipt3"  placeholder="Enter Your Email" required type="email">
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-lock"></i>
                    <input type="password" placeholder="Enter You password" id="PSW" class="PIN1" required>
                    <i class="fa-solid fa-eye" onclick="hid()"></i>
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-lock"></i>
                    <input type="password"   class="PIN2" placeholder="Conform Your Password" id="PWD" oninput="check()" required>
                    <i class="fa-solid fa-eye" onclick="hidd()"></i>
                </div>
                <p class="message1"> Enter the password again</p>

                <div class="button">
                    <input type="submit" value="Reset" class="btn" onclick="p()">

                    <input type="button" value="Back" class="btn" onclick="location.href=('login.html')">
                </div>
            </form>
        </div>
    </div>

</div>

<script>
    function p(){
        console.log(1)
        var name = document.getElementById("Name").value;
        var PIN =  document.getElementById("PSW").value;
        var con_PIN = document.getElementById("PWD").value;
        var email =document.getElementsByClassName("ipt3")[0].value;

        console.log(name,PIN,con_PIN)

        var http=new XMLHttpRequest();
        http.onreadystatechange=function(){
            console.log(2)
            if(this.readyState==4&&this.status==200){
                if(JSON.parse(this.responseText).result){
                    window.location.href="login.html";
                    alert("Password change");
                }else{
                    console.log(10)
                    alert("Failed");
                }
                return;
            }
        }
        http.open("POST","/reset",true);
        http.setRequestHeader("Content-type", "application/json");
        http.send(JSON.stringify({
            name:name,
            email:email,
            PIN:PIN,
            con_PIN:con_PIN
        }));
    }
</script>
</body>
</html>