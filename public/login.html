<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
   <script src="javascripts/login.js"></script>
    <link rel="stylesheet" href="stylesheets/register.css">
<!--    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>-->
    <script src="https://kit.fontawesome.com/f48b9c11bb.js" crossorigin="anonymous"></script>
    <title>Sign in</title>
</head>
<body>
<div class="container">
    <div class="con_forms">
        <img src="images/logo.png" title="The Best Company" alt="This our pretty logo" onclick="location.href=('index.html')">
        <div class="login_register">
            <form action="" class="sign_in">
                <h2 class="title">SIGN IN</h2>
                <div class="input_box">
                    <i class="fa-solid fa-user"></i>
                    <input type="text"  placeholder="Enter You User Name" id="name" required>
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-user"></i>
                   <select id="Acctype">
                       <option>User</option>
                       <option>Admin</option>
                   </select>
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-lock"></i>
                    <input type="password" placeholder="Enter You password" class="PIN0" id="PIN" required >
                    <i class="fa-solid fa-eye" onclick="HID()"></i>
                </div>
                <div class="button">
<!--                    login-->
                    <input type="button" value="Login" class="btn" onclick="login()">
                        <input type="button" value="Register" class="btn" onclick="location.href=('register.html')">
                </div>
                <a href="reset_password.html">
                    <p class="forget">Can't remember your password?</p>
                </a>

                <p style="padding: 1rem; font-size: 1rem;">You can sign in with social media platform</p>
                <div class="social-media">
                    <a href="#" class="s_icons">
                        <i class="fa-brands fa-facebook-f"></i>
                    </a>
                    <a href="#" class="s_icons">
                        <i class="fa-brands fa-twitter"></i>
                   </a>
                    <a href="#" class="s_icons">
                        <i class="fa-brands fa-instagram"></i>
                    </a>
                    <a href="#" class="s_icons">
                        <i class="fa-brands fa-google"></i>
                    </a>
                </div>
            </form>
        </div>
    </div>

</div>
<script>
function login(){
    var name=document.getElementById("name").value;
    var psw=document.getElementById("PIN").value;
    var type=document.getElementById("Acctype");
    var A_type = type.options[type.selectedIndex].value;
    console.log(A_type);
    console.log(psw);
    var http=new XMLHttpRequest();

    http.onreadystatechange=function(){
        if(this.readyState==4&&this.status==200){
            console.log(JSON.parse(this.responseText))
            if(JSON.parse(this.responseText).result){
                console.log(1)
                window.localStorage.clear()
                window.location.href="information.html";
                //console.log(JSON.parse(this.responseText).token)
                //store the token
                window.localStorage.setItem('token',JSON.parse(this.responseText).token)
                //store the username
                window.localStorage.setItem('username',name)
            }else{
                console.log(2)
                alert("Login Failed");
            }
        }
    }

    http.open("POST","/login",true);
    http.setRequestHeader("Content-type", "application/json");
    http.send(JSON.stringify({
       name:name,
       psw:psw,
       A_type:A_type
    }));

}


</script>
</body>
</html>