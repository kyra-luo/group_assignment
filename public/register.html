<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="javascripts/login.js"></script>
    <link rel="stylesheet" href="stylesheets/register.css">
    <script src="https://kit.fontawesome.com/f48b9c11bb.js" crossorigin="anonymous"></script>
    <title>Register</title>
</head>
<body>
<div class="container">
    <div class="con_forms">
        <img class="logo" src="images/logo.png" title="The Best Company" alt="This our pretty logo" style="float: left"  onclick="location.href=('main.html')">
        <div class="login_register">
            <form action="information.html" class="sign_in">
                <h2 class="title">Sign Up</h2>
                <div class="input_box">
                    <i class="fa-solid fa-user"></i>
                    <input type="text"  id="ipt0" placeholder="Enter You First Name" required>
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-user"></i>
                    <input type="text" id="ipt1" placeholder="Enter You Last Name" required>
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-person"></i>
                    <input type="text" class="ipt2" placeholder="Enter You User Name" required>
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-lock"></i>
                    <input type="password"  class="PIN1" placeholder="Enter Your Password"  oninput="myfunction()" required>
                    <i class="fa-solid fa-eye" onclick="hid()"></i>
                </div>
                <p class="message"> Enter 6-16 digit password</p>
                <div class="input_box">
                    <i class="fa-solid fa-lock"></i>
                    <input type="password" class="PIN2" placeholder="Conform Your Password" oninput="check()" required>
                    <i class="fa-solid fa-eye" onclick="hidd()"></i>
                </div>
                <p class="message1"> Enter the password again</p>
                <div class="input_box">
                    <i class="fa-solid fa-envelope"></i>
                    <input type="email"  class="ipt3" placeholder="Enter Your Email" required>
                </div>
                <div class="input_box">
                    <i class="fa-solid fa-mars-and-venus"></i>
                    <select id="gender">
                        <option>Male</option>
                        <option>Female</option>
                    </select>
                </div>
                <div class="button">
                    <input type="button" value="Back to login page" class="btn1" onclick="location.href=('login.html')">
                    <input type="button" value="Create an account" class="btn1" onclick="regi()">
                </div>
            </form>
        </div>
    </div>

</div>
<script>
    function regi() {
        var f_name = document.getElementById("ipt0").value;
        var l_name = document.getElementById("ipt1").value;
        var u_name = document.getElementsByClassName("ipt2")[0].value;
        var Pin_1 = document.getElementsByClassName("PIN1")[0].value;
        var Pin_2 = document.getElementsByClassName("PIN2")[0].value;
        var email_add = document.getElementsByClassName("ipt3")[0].value;
        var Gender=document.getElementById("gender");
        var A_type = Gender.options[Gender.selectedIndex].value;

        //console.log(Gender);
        //console.log(psw);
        if(Pin_1===Pin_2&&Pin_1)
        {
            var http = new XMLHttpRequest();

            http.onreadystatechange = function () {
                if(this.readyState==4&&this.status==200) {
                    if (JSON.parse(this.responseText).result) {
                        //alert("register successful")
                        window.location.href = "login.html"
                        //alert("register successful")
                    } else if (JSON.parse(this.responseText).code === 401) {
                        console.log(12)
                        alert("The email address already used");
                    }
                }
            }
            http.open("POST", "/register", true);
            http.setRequestHeader("Content-type", "application/json");
            http.send(JSON.stringify({
                f_name: f_name,
                l_name: l_name,
                u_name: u_name,
                Pin_1: Pin_1,
                Pin2: Pin_2,
                email_add: email_add,
                //Gender: Gender,
                A_type: A_type
            }));
        }     else if(Pin_1!=Pin_2){
            alert("Password must be exactly same");
        }
    }
</script>
</body>
</html>